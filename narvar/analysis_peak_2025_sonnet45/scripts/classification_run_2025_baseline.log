
================================================================================
ðŸš€ BigQuery Traffic Classification - Multi-Period Automation
================================================================================
Mode: all
Dry run: False
Target table: narvar-data-lake.query_opt.traffic_classification
Classification version: v1.2
================================================================================

ðŸ“… Periods to classify: 4
   1. Baseline_2025_Sep_Oct          (2025-09-01 to 2025-10-31) - Most recent baseline (Sep-Oct 2025) - freshest pre-peak data
   2. Peak_2022_2023                 (2022-11-01 to 2023-01-31) - Historical peak for 3-year trend - RE-RUN with improved patterns
   3. NonPeak_2023_Feb_Mar           (2023-02-01 to 2023-03-31) - Post-peak 2022-2023 baseline - RE-RUN with improved patterns
   4. NonPeak_2022_Sep_Oct           (2022-09-01 to 2022-10-31) - Pre-peak 2022-2023 baseline - RE-RUN with improved patterns

âš ï¸  Proceed with classification? This will take ~60 minutes. [y/N]: âœ… Connected to BigQuery project: narvar-data-lake


################################################################################
# RUN 1/4
################################################################################

================================================================================
ðŸ”„ Processing: Baseline_2025_Sep_Oct
   Description: Most recent baseline (Sep-Oct 2025) - freshest pre-peak data
   Period: 2025-09-01 to 2025-10-31
   Type: NON_PEAK
================================================================================
   â³ Query job started: 1662d28a-8405-4648-b9ab-c43feba610e7
   â³ Waiting for completion...
   âœ… Completed in 0.2 minutes
   ðŸ“Š Bytes processed: 28.09 GB
   ðŸ“Š Slot milliseconds: 1,260,404

   ðŸ“Š Validation Results:
      Jobs classified: 4,471,150
      Unclassified: 16.15%
      Slot hours: 2,039,022
      Estimated cost: $100,868
      Unique retailers: 210
      âš ï¸  WARNING: High unclassified rate (16.1%)


################################################################################
# RUN 2/4
################################################################################

================================================================================
ðŸ”„ Processing: Peak_2022_2023
   Description: Historical peak for 3-year trend - RE-RUN with improved patterns
   Period: 2022-11-01 to 2023-01-31
   Type: PEAK
================================================================================
   â³ Query job started: 8f734717-c770-4b0f-9d3c-8b0e9b319eda
   â³ Waiting for completion...
   âœ… Completed in 0.3 minutes
   ðŸ“Š Bytes processed: 41.25 GB
   ðŸ“Š Slot milliseconds: 2,644,258

   ðŸ“Š Validation Results:
      Jobs classified: 22,688,322
      Unclassified: 0.00%
      Slot hours: 6,784,449
      Estimated cost: $335,356
      Unique retailers: 523
      âœ… Excellent classification rate!


################################################################################
# RUN 3/4
################################################################################

================================================================================
ðŸ”„ Processing: NonPeak_2023_Feb_Mar
   Description: Post-peak 2022-2023 baseline - RE-RUN with improved patterns
   Period: 2023-02-01 to 2023-03-31
   Type: NON_PEAK
================================================================================
   â³ Query job started: ad8bab7a-d0bf-44fb-b685-8e43291ab857
   â³ Waiting for completion...
   âœ… Completed in 0.2 minutes
   ðŸ“Š Bytes processed: 21.71 GB
   ðŸ“Š Slot milliseconds: 1,338,953

   ðŸ“Š Validation Results:
      Jobs classified: 10,031,778
      Unclassified: 0.00%
      Slot hours: 1,628,568
      Estimated cost: $80,538
      Unique retailers: 500
      âœ… Excellent classification rate!


################################################################################
# RUN 4/4
################################################################################

================================================================================
ðŸ”„ Processing: NonPeak_2022_Sep_Oct
   Description: Pre-peak 2022-2023 baseline - RE-RUN with improved patterns
   Period: 2022-09-01 to 2022-10-31
   Type: NON_PEAK
================================================================================
   â³ Query job started: 23b6dbf5-b51c-4c5d-b25a-056c9603c735
   â³ Waiting for completion...
   âœ… Completed in 0.2 minutes
   ðŸ“Š Bytes processed: 39.13 GB
   ðŸ“Š Slot milliseconds: 1,743,180

   ðŸ“Š Validation Results:
      Jobs classified: 14,929,950
      Unclassified: 0.00%
      Slot hours: 4,949,130
      Estimated cost: $244,640
      Unique retailers: 514
      âœ… Excellent classification rate!


================================================================================
ðŸ“Š CLASSIFICATION RUN SUMMARY
================================================================================

âœ… Successful runs: 4

Period                         Jobs         Unclass %    Slot Hours      Cost         Runtime
----------------------------------------------------------------------------------------------------
Baseline_2025_Sep_Oct            4,471,150       16.1%      2,039,022 $   100,868     0.2 min
Peak_2022_2023                  22,688,322        0.0%      6,784,449 $   335,356     0.3 min
NonPeak_2023_Feb_Mar            10,031,778        0.0%      1,628,568 $    80,538     0.2 min
NonPeak_2022_Sep_Oct            14,929,950        0.0%      4,949,130 $   244,640     0.2 min
----------------------------------------------------------------------------------------------------
TOTAL                           52,121,200                              $   761,402     0.9 min

================================================================================


ðŸŽ¯ Next Steps:
   1. Review validation results above
   2. Check for any periods with >5% unclassified
   3. If quality is good, proceed to Phase 2 analysis
   4. Query the table: `narvar-data-lake.query_opt.traffic_classification`
