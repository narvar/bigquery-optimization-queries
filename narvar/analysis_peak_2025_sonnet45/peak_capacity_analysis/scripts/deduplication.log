
‚úÖ Connected to BigQuery project: narvar-data-lake

====================================================================================================
üîß TRAFFIC CLASSIFICATION TABLE DEDUPLICATION
====================================================================================================
Project: narvar-data-lake
Dataset: query_opt
Table: traffic_classification
Mode: EXECUTE (will make changes)
====================================================================================================

üìä Current Table Statistics
====================================================================================================
Total rows:         87,013,789
Unique jobs:        39,363,739
Duplicate rows:     47,650,050 (54.8%)
Unique versions:             3
Unique periods:              8
====================================================================================================

üìä Current Table: Breakdown by Period and Version
========================================================================================================================
Period                    Version            Rows  Unique Jobs      Slot Hours
------------------------------------------------------------------------------------------------------------------------
Baseline_2024_Sep_Oct     v1.0          3,788,309    3,788,309       1,627,461
NonPeak_2022_Sep_Oct      v1.0          7,464,975    7,464,975       2,474,565
NonPeak_2022_Sep_Oct      v1.1          7,464,975    7,464,975       2,474,565
NonPeak_2022_Sep_Oct      v1.2          7,464,975    7,464,975       2,474,565
NonPeak_2023_Feb_Mar      v1.0          5,015,889    5,015,889         814,284
NonPeak_2023_Feb_Mar      v1.1          5,015,889    5,015,889         814,284
NonPeak_2023_Feb_Mar      v1.2          5,015,889    5,015,889         814,284
NonPeak_2023_Sep_Oct      v1.0          1,876,673    1,876,673         976,896
NonPeak_2024_Feb_Mar      v1.0          1,864,763    1,864,763       1,175,135
Peak_2022_2023            v1.0         11,344,161   11,344,161       3,392,224
Peak_2022_2023            v1.1         11,344,161   11,344,161       3,392,224
Peak_2022_2023            v1.2         11,344,161   11,344,161       3,392,224
Peak_2023_2024            v1.0          3,287,346    3,287,346       1,632,269
Peak_2024_2025            v1.0          4,721,623    4,721,623       2,818,053
========================================================================================================================

====================================================================================================
‚öôÔ∏è  EXECUTING DEDUPLICATION
====================================================================================================

1Ô∏è‚É£  Creating backup table...
   ‚úÖ Backup created: traffic_classification_backup

2Ô∏è‚É£  Creating deduplicated table...
   ‚úÖ Deduplicated table created: traffic_classification_deduped
   üìä Bytes processed: 56.75 GB


üìä Deduplicated Table Statistics
====================================================================================================
Total rows:         39,363,739
Unique jobs:        39,363,739
Duplicate rows:              0 (0.0%)
Unique versions:             2
Unique periods:              8
====================================================================================================

====================================================================================================
‚ö†Ô∏è  READY TO REPLACE ORIGINAL TABLE
====================================================================================================
Backup exists at: narvar-data-lake.query_opt.traffic_classification_backup

This will:
  1. DROP traffic_classification
  2. RENAME traffic_classification_deduped ‚Üí traffic_classification
  3. DROP traffic_classification_deduped

Proceed with replacement? [yes/NO]: 
3Ô∏è‚É£  Replacing original table with deduplicated version...
   ‚úÖ Table replaced successfully!
   ‚úÖ Backup available at: traffic_classification_backup


‚úÖ Final Table Statistics
====================================================================================================
Total rows:         39,363,739
Unique jobs:        39,363,739
Duplicate rows:              0 (0.0%)
Unique versions:             2
Unique periods:              8
====================================================================================================

====================================================================================================
‚úÖ DEDUPLICATION COMPLETE!
====================================================================================================
‚úÖ Duplicates removed
‚úÖ Latest versions retained
‚úÖ Backup available: traffic_classification_backup
====================================================================================================
