
================================================================================
ðŸš€ BigQuery Traffic Classification - Multi-Period Automation
================================================================================
Mode: all
Dry run: False
Target table: narvar-data-lake.query_opt.traffic_classification
Classification version: v1.1
================================================================================

ðŸ“… Periods to classify: 3
   1. Peak_2022_2023                 (2022-11-01 to 2023-01-31) - Historical peak for 3-year trend - RE-RUN with improved patterns
   2. NonPeak_2023_Feb_Mar           (2023-02-01 to 2023-03-31) - Post-peak 2022-2023 baseline - RE-RUN with improved patterns
   3. NonPeak_2022_Sep_Oct           (2022-09-01 to 2022-10-31) - Pre-peak 2022-2023 baseline - RE-RUN with improved patterns

âš ï¸  Proceed with classification? This will take ~45 minutes. [y/N]: âœ… Connected to BigQuery project: narvar-data-lake


################################################################################
# RUN 1/3
################################################################################

================================================================================
ðŸ”„ Processing: Peak_2022_2023
   Description: Historical peak for 3-year trend - RE-RUN with improved patterns
   Period: 2022-11-01 to 2023-01-31
   Type: PEAK
================================================================================
   â³ Query job started: 2de5c27a-01ac-4eb9-8849-0541462f2c6a
   â³ Waiting for completion...
   âœ… Completed in 0.3 minutes
   ðŸ“Š Bytes processed: 41.25 GB
   ðŸ“Š Slot milliseconds: 2,918,161

   ðŸ“Š Validation Results:
      Jobs classified: 22,688,322
      Unclassified: 20.47%
      Slot hours: 6,784,449
      Estimated cost: $335,356
      Unique retailers: 523
      âš ï¸  WARNING: High unclassified rate (20.5%)


################################################################################
# RUN 2/3
################################################################################

================================================================================
ðŸ”„ Processing: NonPeak_2023_Feb_Mar
   Description: Post-peak 2022-2023 baseline - RE-RUN with improved patterns
   Period: 2023-02-01 to 2023-03-31
   Type: NON_PEAK
================================================================================
   â³ Query job started: 300c5127-c0a6-4288-a48e-06d4e094aff9
   â³ Waiting for completion...
   âœ… Completed in 0.3 minutes
   ðŸ“Š Bytes processed: 21.71 GB
   ðŸ“Š Slot milliseconds: 1,617,051

   ðŸ“Š Validation Results:
      Jobs classified: 10,031,778
      Unclassified: 31.06%
      Slot hours: 1,628,568
      Estimated cost: $80,538
      Unique retailers: 500
      âš ï¸  WARNING: High unclassified rate (31.1%)


################################################################################
# RUN 3/3
################################################################################

================================================================================
ðŸ”„ Processing: NonPeak_2022_Sep_Oct
   Description: Pre-peak 2022-2023 baseline - RE-RUN with improved patterns
   Period: 2022-09-01 to 2022-10-31
   Type: NON_PEAK
================================================================================
   â³ Query job started: d8d431f6-603d-42d8-92ca-01efd4e49a29
   â³ Waiting for completion...
   âœ… Completed in 0.4 minutes
   ðŸ“Š Bytes processed: 39.13 GB
   ðŸ“Š Slot milliseconds: 2,670,634

   ðŸ“Š Validation Results:
      Jobs classified: 14,929,950
      Unclassified: 17.60%
      Slot hours: 4,949,130
      Estimated cost: $244,640
      Unique retailers: 514
      âš ï¸  WARNING: High unclassified rate (17.6%)


================================================================================
ðŸ“Š CLASSIFICATION RUN SUMMARY
================================================================================

âœ… Successful runs: 3

Period                         Jobs         Unclass %    Slot Hours      Cost         Runtime
----------------------------------------------------------------------------------------------------
Peak_2022_2023                  22,688,322       20.5%      6,784,449 $   335,356     0.3 min
NonPeak_2023_Feb_Mar            10,031,778       31.1%      1,628,568 $    80,538     0.3 min
NonPeak_2022_Sep_Oct            14,929,950       17.6%      4,949,130 $   244,640     0.4 min
----------------------------------------------------------------------------------------------------
TOTAL                           47,650,050                              $   660,534     0.9 min

================================================================================


ðŸŽ¯ Next Steps:
   1. Review validation results above
   2. Check for any periods with >5% unclassified
   3. If quality is good, proceed to Phase 2 analysis
   4. Query the table: `narvar-data-lake.query_opt.traffic_classification`
